<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Algerie-Market | Ù…Ù†ØµØ© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±ÙŠØ©</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800;900&family=Cairo:wght@300;400;600;700;900&display=swap" rel="stylesheet">

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
  import { getAuth, GoogleAuthProvider, signInWithPopup, signOut, onAuthStateChanged }
    from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
  import { getFirestore, collection, addDoc, getDocs, query, orderBy, serverTimestamp }
    from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey:            "AIzaSyCyejRGX1nfr8vACwQeLUsa1kIshWwQZj4",
    authDomain:        "market-algerie.firebaseapp.com",
    projectId:         "market-algerie",
    storageBucket:     "market-algerie.firebasestorage.app",
    messagingSenderId: "915670005616",
    appId:             "1:915670005616:web:4285c55bc20c6294cf01b5",
    measurementId:     "G-L25TLETKF3"
  };

  const app      = initializeApp(firebaseConfig);
  const auth     = getAuth(app);
  const db       = getFirestore(app);
  const provider = new GoogleAuthProvider();

  window.firebaseLoginWithGoogle = async () => {
    try {
      const result = await signInWithPopup(auth, provider);
      return result.user;
    } catch (err) {
      alert("ÙØ´Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„: " + err.message);
      return null;
    }
  };

  window.firebaseLogout = async () => { await signOut(auth); };

  window.firebaseSaveAd = async (adData) => {
    const user = auth.currentUser;
    if (!user) throw new Error("ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹");
    const docRef = await addDoc(collection(db, "ads"), {
      ...adData,
      userId: user.uid, userName: user.displayName,
      userEmail: user.email, userPhoto: user.photoURL,
      createdAt: serverTimestamp()
    });
    return docRef.id;
  };

  window.firebaseGetAds = async () => {
    const q = query(collection(db, "ads"), orderBy("createdAt", "desc"));
    const snap = await getDocs(q);
    return snap.docs.map(d => ({ id: d.id, ...d.data() }));
  };

  onAuthStateChanged(auth, (user) => {
    window.currentUser = user || null;
    const navActions = document.getElementById('navActions');
    if (!navActions) return;
    if (user) {
      navActions.innerHTML = `
        <div style="display:flex;align-items:center;gap:12px;">
          <img src="${user.photoURL||''}" onerror="this.style.display='none'"
               style="width:36px;height:36px;border-radius:50%;border:2px solid var(--primary);">
          <span style="font-size:.88rem;color:var(--text-muted);max-width:120px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">${user.displayName||user.email}</span>
          <button class="btn-add" onclick="openModal()"><span class="plus">+</span> Ø£Ø¶Ù Ø¥Ø¹Ù„Ø§Ù†Ùƒ</button>
          <button onclick="logoutUser()" style="background:transparent;border:1px solid var(--border);color:var(--text-muted);padding:8px 16px;border-radius:30px;cursor:pointer;font-family:'Tajawal',sans-serif;font-size:.85rem;"
            onmouseover="this.style.borderColor='var(--primary)';this.style.color='var(--primary)'"
            onmouseout="this.style.borderColor='var(--border)';this.style.color='var(--text-muted)'">Ø®Ø±ÙˆØ¬</button>
        </div>`;
    } else {
      navActions.innerHTML = `<button class="btn-add" onclick="openModal()"><span class="plus">+</span> Ø£Ø¶Ù Ø¥Ø¹Ù„Ø§Ù†Ùƒ</button>`;
    }
  });
</script>

<style>
  :root {
    --primary:#FF6B35;--primary-dark:#e55a26;--secondary:#1A1A2E;--accent:#FFD700;
    --accent2:#16213E;--surface:#0F3460;--bg:#070B1A;--card:rgba(22,33,62,0.8);
    --text:#F0F0F0;--text-muted:#8899BB;--border:rgba(255,107,53,0.2);
    --success:#00C896;--gradient:linear-gradient(135deg,#FF6B35,#FFD700);
  }
  *{margin:0;padding:0;box-sizing:border-box;}
  body{font-family:'Tajawal',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;overflow-x:hidden;}
  body::before{content:'';position:fixed;inset:0;background:radial-gradient(ellipse 80% 50% at 20% 20%,rgba(255,107,53,0.12) 0%,transparent 60%),radial-gradient(ellipse 60% 40% at 80% 80%,rgba(255,215,0,0.08) 0%,transparent 60%);pointer-events:none;z-index:0;}
  nav{position:sticky;top:0;z-index:1000;background:rgba(7,11,26,0.85);backdrop-filter:blur(20px);border-bottom:1px solid var(--border);padding:0 2rem;height:72px;display:flex;align-items:center;justify-content:space-between;}
  .logo{display:flex;align-items:center;gap:10px;text-decoration:none;}
  .logo-icon{width:44px;height:44px;background:var(--gradient);border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:22px;box-shadow:0 4px 20px rgba(255,107,53,0.4);animation:pulse-glow 3s ease-in-out infinite;flex-shrink:0;}
  .logo-text{display:flex;flex-direction:column;line-height:1.15;}
  .logo-text .name{font-size:1.3rem;font-weight:900;background:var(--gradient);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;font-family:'Cairo',sans-serif;direction:ltr;white-space:nowrap;}
  .logo-text .tagline{font-size:.6rem;color:var(--text-muted);font-weight:300;white-space:nowrap;}
  @keyframes pulse-glow{0%,100%{box-shadow:0 4px 20px rgba(255,107,53,0.4);}50%{box-shadow:0 4px 35px rgba(255,107,53,0.7),0 0 60px rgba(255,215,0,0.2);}}
  .nav-actions{display:flex;align-items:center;gap:12px;}
  .btn-add{background:var(--gradient);color:#fff;border:none;padding:10px 24px;border-radius:50px;font-family:'Tajawal',sans-serif;font-size:.95rem;font-weight:700;cursor:pointer;display:flex;align-items:center;gap:8px;transition:all .3s ease;box-shadow:0 4px 20px rgba(255,107,53,0.3);}
  .btn-add:hover{transform:translateY(-2px);box-shadow:0 8px 30px rgba(255,107,53,0.5);}
  .btn-add .plus{width:22px;height:22px;background:rgba(255,255,255,0.25);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.1rem;font-weight:300;}
  .hero{position:relative;z-index:1;text-align:center;padding:80px 2rem 60px;}
  .hero-badge{display:inline-flex;align-items:center;gap:8px;background:rgba(255,107,53,0.1);border:1px solid rgba(255,107,53,0.3);border-radius:50px;padding:6px 18px;font-size:.82rem;color:var(--primary);margin-bottom:24px;animation:fadeInDown .6s ease;}
  .hero h1{font-family:'Cairo',sans-serif;font-size:clamp(2.2rem,5vw,3.8rem);font-weight:900;line-height:1.2;margin-bottom:16px;animation:fadeInDown .7s ease;}
  .hero h1 span{background:var(--gradient);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;}
  .hero p{color:var(--text-muted);font-size:1.05rem;max-width:500px;margin:0 auto 40px;animation:fadeInDown .8s ease;}
  .search-container{max-width:700px;margin:0 auto 60px;position:relative;animation:fadeInUp .9s ease;z-index:1;}
  .search-bar{display:flex;background:rgba(22,33,62,0.9);border:1px solid var(--border);border-radius:60px;overflow:hidden;box-shadow:0 8px 40px rgba(0,0,0,0.4);transition:all .3s ease;}
  .search-bar:focus-within{border-color:var(--primary);box-shadow:0 8px 40px rgba(255,107,53,0.2),0 0 0 4px rgba(255,107,53,0.08);}
  .search-input{flex:1;background:transparent;border:none;padding:18px 24px;font-family:'Tajawal',sans-serif;font-size:1rem;color:var(--text);outline:none;text-align:right;}
  .search-input::placeholder{color:var(--text-muted);}
  .search-btn{background:var(--gradient);border:none;padding:14px 28px;margin:6px;border-radius:50px;cursor:pointer;color:white;font-size:1.1rem;transition:all .2s ease;}
  .stats{display:flex;justify-content:center;gap:40px;margin-bottom:70px;flex-wrap:wrap;z-index:1;position:relative;animation:fadeInUp 1s ease;}
  .stat-item{text-align:center;}
  .stat-item .num{font-size:2rem;font-weight:900;background:var(--gradient);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;font-family:'Cairo',sans-serif;}
  .stat-item .label{font-size:.8rem;color:var(--text-muted);margin-top:2px;}
  .section-title{text-align:center;margin-bottom:40px;position:relative;z-index:1;}
  .section-title h2{font-family:'Cairo',sans-serif;font-size:1.8rem;font-weight:800;}
  .section-title p{color:var(--text-muted);font-size:.9rem;margin-top:6px;}
  .section-title .line{width:50px;height:3px;background:var(--gradient);margin:12px auto 0;border-radius:3px;}
  .categories-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:14px;max-width:1100px;margin:0 auto;padding:0 2rem;position:relative;z-index:1;}
  .cat-card{background:var(--card);border:1px solid var(--border);border-radius:18px;padding:18px 10px 14px;text-align:center;cursor:pointer;transition:all .3s ease;backdrop-filter:blur(10px);position:relative;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;min-height:110px;}
  .cat-card.active-cat{border-color:var(--primary);background:rgba(255,107,53,0.12);box-shadow:0 0 0 2px rgba(255,107,53,0.3);}
  .cat-card::before{content:'';position:absolute;inset:0;border-radius:18px;background:var(--gradient);opacity:0;transition:opacity .3s ease;z-index:0;}
  .cat-card:hover{transform:translateY(-4px);border-color:var(--primary);box-shadow:0 12px 40px rgba(255,107,53,0.2);}
  .cat-card:hover::before{opacity:.05;}
  .cat-icon{font-size:2rem;display:block;position:relative;z-index:2;line-height:1;}
  .cat-name{font-size:.85rem;font-weight:700;position:relative;z-index:2;}
  .cat-count{font-size:.7rem;color:var(--text-muted);position:relative;z-index:2;}
  .cat-ads-panel{max-width:1100px;margin:0 auto;padding:0 2rem;position:relative;z-index:1;}
  .cat-ads-inner{background:rgba(15,26,53,0.7);border:1px solid var(--border);border-radius:24px;padding:28px;margin-top:16px;backdrop-filter:blur(12px);animation:slideDown .35s cubic-bezier(0.34,1.2,0.64,1);}
  @keyframes slideDown{from{opacity:0;transform:translateY(-16px);}to{opacity:1;transform:translateY(0);}}
  .cat-panel-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:20px;flex-wrap:wrap;gap:12px;}
  .cat-panel-title{font-family:'Cairo',sans-serif;font-size:1.15rem;font-weight:800;display:flex;align-items:center;gap:10px;}
  .cat-panel-count{font-size:.78rem;background:rgba(255,107,53,0.12);border:1px solid rgba(255,107,53,0.25);color:var(--primary);padding:3px 12px;border-radius:20px;font-weight:600;}
  .btn-panel-close{background:rgba(255,255,255,0.06);border:1px solid var(--border);color:var(--text-muted);width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:1rem;transition:all .2s;}
  .btn-panel-close:hover{color:var(--primary);border-color:var(--primary);}
  .btn-add-in-cat{background:var(--gradient);color:white;border:none;padding:9px 20px;border-radius:30px;font-family:'Tajawal',sans-serif;font-size:.88rem;font-weight:700;cursor:pointer;transition:all .2s;display:flex;align-items:center;gap:6px;box-shadow:0 4px 15px rgba(255,107,53,0.3);}
  .btn-add-in-cat:hover{transform:translateY(-1px);box-shadow:0 6px 20px rgba(255,107,53,0.45);}
  .panel-ads-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:16px;}
  .panel-empty{text-align:center;padding:40px 20px;color:var(--text-muted);}
  .panel-empty .empty-icon{font-size:3rem;display:block;margin-bottom:12px;}
  .panel-empty p{font-size:.9rem;margin-bottom:16px;}
  .ads-section{max-width:1200px;margin:60px auto 80px;padding:0 2rem;position:relative;z-index:1;}
  .filter-tabs{display:flex;gap:10px;margin-bottom:30px;flex-wrap:wrap;}
  .filter-tab{background:transparent;border:1px solid var(--border);color:var(--text-muted);padding:8px 20px;border-radius:50px;font-family:'Tajawal',sans-serif;font-size:.88rem;cursor:pointer;transition:all .2s ease;}
  .filter-tab.active,.filter-tab:hover{background:var(--gradient);border-color:transparent;color:white;font-weight:700;}
  .ads-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:20px;}
  .ad-card{background:var(--card);border:1px solid var(--border);border-radius:20px;overflow:hidden;cursor:pointer;transition:all .3s ease;backdrop-filter:blur(10px);animation:fadeInUp .5s ease backwards;}
  .ad-card:hover{transform:translateY(-4px);box-shadow:0 16px 50px rgba(0,0,0,0.4);border-color:rgba(255,107,53,0.4);}
  .ad-image{height:180px;background:linear-gradient(135deg,var(--surface),var(--accent2));display:flex;align-items:center;justify-content:center;font-size:3.5rem;position:relative;}
  .ad-badge{position:absolute;top:12px;right:12px;background:var(--primary);color:white;font-size:.7rem;font-weight:700;padding:4px 10px;border-radius:20px;}
  .ad-badge.sale{background:var(--success);}
  .ad-body{padding:18px;}
  .ad-title{font-size:.98rem;font-weight:700;margin-bottom:6px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
  .ad-meta{display:flex;gap:12px;color:var(--text-muted);font-size:.78rem;margin-bottom:14px;}
  .ad-price{font-size:1.3rem;font-weight:900;background:var(--gradient);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;font-family:'Cairo',sans-serif;}
  .ad-footer{display:flex;justify-content:space-between;align-items:center;margin-top:12px;padding-top:12px;border-top:1px solid var(--border);}
  .ad-seller{display:flex;align-items:center;gap:8px;font-size:.8rem;color:var(--text-muted);}
  .seller-avatar{width:28px;height:28px;border-radius:50%;background:var(--gradient);display:flex;align-items:center;justify-content:center;font-size:.75rem;color:white;font-weight:700;overflow:hidden;}
  .seller-avatar img{width:100%;height:100%;object-fit:cover;}
  .btn-contact{background:transparent;border:1px solid var(--primary);color:var(--primary);padding:6px 14px;border-radius:20px;font-family:'Tajawal',sans-serif;font-size:.8rem;cursor:pointer;transition:all .2s ease;}
  .btn-contact:hover{background:var(--primary);color:white;}
  .modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.75);backdrop-filter:blur(10px);z-index:9999;display:flex;align-items:center;justify-content:center;padding:1rem;opacity:0;visibility:hidden;transition:all .3s ease;}
  .modal-overlay.open{opacity:1;visibility:visible;}
  .modal{background:linear-gradient(145deg,#0F1A35,#162130);border:1px solid var(--border);border-radius:28px;width:100%;max-width:520px;max-height:90vh;overflow-y:auto;transform:scale(.92) translateY(20px);transition:all .35s cubic-bezier(0.34,1.56,0.64,1);box-shadow:0 30px 100px rgba(0,0,0,0.6);}
  .modal-overlay.open .modal{transform:scale(1) translateY(0);}
  .modal-header{padding:28px 28px 20px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;}
  .modal-title{font-size:1.3rem;font-weight:800;font-family:'Cairo',sans-serif;}
  .modal-close{width:36px;height:36px;border-radius:50%;background:rgba(255,255,255,0.07);border:none;color:var(--text-muted);font-size:1.2rem;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s;}
  .modal-close:hover{background:rgba(255,107,53,0.2);color:var(--primary);}
  .modal-body{padding:28px;}
  .auth-step{text-align:center;}
  .auth-icon{font-size:3rem;margin-bottom:16px;}
  .auth-title{font-size:1.1rem;font-weight:700;margin-bottom:8px;font-family:'Cairo',sans-serif;}
  .auth-sub{color:var(--text-muted);font-size:.88rem;margin-bottom:28px;}
  .btn-google{display:flex;align-items:center;justify-content:center;gap:12px;width:100%;padding:14px 20px;background:white;color:#333;border:none;border-radius:14px;font-family:'Tajawal',sans-serif;font-size:1rem;font-weight:700;cursor:pointer;transition:all .3s ease;box-shadow:0 4px 20px rgba(0,0,0,0.3);}
  .btn-google:hover{transform:translateY(-2px);box-shadow:0 8px 30px rgba(0,0,0,0.4);}
  .google-logo{width:22px;height:22px;background:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%234285F4' d='M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z'/%3E%3Cpath fill='%2334A853' d='M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z'/%3E%3Cpath fill='%23FBBC05' d='M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z'/%3E%3Cpath fill='%23EA4335' d='M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z'/%3E%3C/svg%3E") center/contain no-repeat;flex-shrink:0;}
  .divider{display:flex;align-items:center;gap:12px;margin:20px 0;color:var(--text-muted);font-size:.82rem;}
  .divider::before,.divider::after{content:'';flex:1;height:1px;background:var(--border);}
  .steps-indicator{display:flex;align-items:center;gap:8px;justify-content:center;margin-bottom:28px;}
  .step-dot{width:8px;height:8px;border-radius:50%;background:var(--border);transition:all .3s;}
  .step-dot.active{background:var(--primary);width:24px;border-radius:4px;}
  .step-dot.done{background:var(--success);}
  .cats-select{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-bottom:20px;}
  .cat-select-item{background:rgba(22,33,62,0.6);border:2px solid var(--border);border-radius:14px;padding:14px 8px;text-align:center;cursor:pointer;transition:all .2s ease;}
  .cat-select-item:hover,.cat-select-item.selected{border-color:var(--primary);background:rgba(255,107,53,0.08);}
  .cat-select-item .icon{font-size:1.6rem;display:block;margin-bottom:4px;}
  .cat-select-item .name{font-size:.75rem;font-weight:600;}
  .form-group{margin-bottom:18px;}
  .form-label{display:block;font-size:.88rem;font-weight:600;margin-bottom:8px;}
  .form-label span{color:var(--primary);}
  .form-control{width:100%;background:rgba(22,33,62,0.8);border:1px solid var(--border);border-radius:12px;padding:12px 16px;font-family:'Tajawal',sans-serif;font-size:.95rem;color:var(--text);outline:none;transition:all .2s ease;text-align:right;}
  .form-control:focus{border-color:var(--primary);box-shadow:0 0 0 3px rgba(255,107,53,0.12);}
  .form-control::placeholder{color:var(--text-muted);}
  textarea.form-control{resize:vertical;min-height:90px;}
  select.form-control{cursor:pointer;direction:rtl;}
  .form-row{display:grid;grid-template-columns:1fr 1fr;gap:14px;}
  .image-upload{border:2px dashed var(--border);border-radius:14px;padding:30px;text-align:center;cursor:pointer;transition:all .2s ease;color:var(--text-muted);font-size:.88rem;}
  .image-upload:hover{border-color:var(--primary);background:rgba(255,107,53,0.04);color:var(--text);}
  .image-upload .upload-icon{font-size:2.2rem;display:block;margin-bottom:8px;}
  .btn-submit{width:100%;background:var(--gradient);color:white;border:none;border-radius:14px;padding:16px;font-family:'Tajawal',sans-serif;font-size:1.05rem;font-weight:700;cursor:pointer;transition:all .3s ease;box-shadow:0 6px 25px rgba(255,107,53,0.35);margin-top:8px;}
  .btn-submit:hover{transform:translateY(-2px);box-shadow:0 10px 35px rgba(255,107,53,0.5);}
  .btn-submit:disabled{opacity:.6;cursor:not-allowed;transform:none;}
  .btn-back{width:100%;background:transparent;border:1px solid var(--border);color:var(--text-muted);border-radius:14px;padding:13px;font-family:'Tajawal',sans-serif;font-size:.95rem;cursor:pointer;margin-top:10px;transition:all .2s ease;}
  .btn-back:hover{border-color:var(--primary);color:var(--primary);}
  .success-state{text-align:center;padding:20px 0;}
  .success-icon{width:80px;height:80px;background:rgba(0,200,150,0.15);border:2px solid var(--success);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:2.2rem;margin:0 auto 20px;animation:success-pop .5s cubic-bezier(0.34,1.56,0.64,1);}
  @keyframes success-pop{0%{transform:scale(0);opacity:0}100%{transform:scale(1);opacity:1}}
  .spinner{display:inline-block;width:20px;height:20px;border:2px solid rgba(255,255,255,0.3);border-top-color:white;border-radius:50%;animation:spin .8s linear infinite;vertical-align:middle;margin-left:8px;}
  @keyframes spin{to{transform:rotate(360deg);}}
  .toast{position:fixed;bottom:30px;left:50%;transform:translateX(-50%) translateY(100px);background:var(--success);color:white;padding:14px 28px;border-radius:50px;font-weight:700;font-size:.95rem;z-index:99999;transition:transform .4s cubic-bezier(0.34,1.56,0.64,1);box-shadow:0 8px 30px rgba(0,200,150,0.4);}
  .toast.show{transform:translateX(-50%) translateY(0);}
  footer{text-align:center;padding:40px 2rem;border-top:1px solid var(--border);color:var(--text-muted);font-size:.85rem;position:relative;z-index:1;}
  footer .footer-logo{font-family:'Cairo',sans-serif;font-size:1.4rem;font-weight:900;background:var(--gradient);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;margin-bottom:12px;}
  @keyframes fadeInDown{from{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}
  @keyframes fadeInUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}
  .ad-card:nth-child(1){animation-delay:.1s}.ad-card:nth-child(2){animation-delay:.15s}.ad-card:nth-child(3){animation-delay:.2s}.ad-card:nth-child(4){animation-delay:.25s}.ad-card:nth-child(5){animation-delay:.3s}.ad-card:nth-child(6){animation-delay:.35s}
  ::-webkit-scrollbar{width:6px}::-webkit-scrollbar-track{background:var(--bg)}::-webkit-scrollbar-thumb{background:var(--surface);border-radius:3px}::-webkit-scrollbar-thumb:hover{background:var(--primary)}
  @media(max-width:600px){.form-row{grid-template-columns:1fr}.cats-select{grid-template-columns:repeat(3,1fr)}nav{padding:0 1rem}.hero{padding:50px 1rem 40px}.categories-grid{grid-template-columns:repeat(4,1fr);gap:10px;padding:0 1rem}}
</style>
</head>
<body>

<nav>
  <a href="#" class="logo">
    <div class="logo-icon">ğŸ›’</div>
    <div class="logo-text">
      <span class="name">Algerie-Market</span>
      <span class="tagline">Ø¨ÙŠØ¹ Â· Ø§Ø´ØªØ±Ù Â· ØªØ¨Ø§Ø¯Ù„ ÙÙŠ Ø§Ù„Ø¬Ø²Ø§Ø¦Ø± ğŸ‡©ğŸ‡¿</span>
    </div>
  </a>
  <div class="nav-actions" id="navActions">
    <button class="btn-add" onclick="openModal()">
      <span class="plus">+</span> Ø£Ø¶Ù Ø¥Ø¹Ù„Ø§Ù†Ùƒ
    </button>
  </div>
</nav>

<section class="hero">
  <div class="hero-badge">ğŸ‡©ğŸ‡¿ Ø§Ù„Ù…Ù†ØµØ© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†ÙŠØ© Ø§Ù„Ø£ÙˆÙ„Ù‰ ÙÙŠ Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±</div>
  <h1>Ø§Ø¹Ø±Ø¶ Ù…ÙÙ†ØªØ¬Ùƒ<br><span>ÙˆØ§Ø¨Ø¯Ø£ Ø§Ù„Ø¨ÙŠØ¹ ÙÙŠ Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±</span></h1>
  <p>Ø¢Ù„Ø§Ù Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ© ÙÙŠ ÙƒÙ„ ÙˆÙ„Ø§ÙŠØ§Øª Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±. Ø¨Ø³Ù‡ÙˆÙ„Ø© ØªØ§Ù…Ø© ÙˆØ¨Ø¯ÙˆÙ† Ø£ÙŠ Ø±Ø³ÙˆÙ…</p>
</section>

<div class="search-container">
  <div class="search-bar">
    <input class="search-input" type="text" placeholder="Ø§Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±... Ø³ÙŠØ§Ø±Ø§ØªØŒ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§ØªØŒ Ø¹Ù‚Ø§Ø±Ø§Øª...">
    <button class="search-btn">ğŸ”</button>
  </div>
</div>

<div class="stats">
  <div class="stat-item"><div class="num">+45K</div><div class="label">Ø¥Ø¹Ù„Ø§Ù† Ù†Ø´Ø·</div></div>
  <div class="stat-item"><div class="num">+12K</div><div class="label">Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„</div></div>
  <div class="stat-item"><div class="num">+98%</div><div class="label">Ù†Ø³Ø¨Ø© Ø§Ù„Ø±Ø¶Ø§</div></div>
  <div class="stat-item"><div class="num">58</div><div class="label">ÙˆÙ„Ø§ÙŠØ© Ù…ØºØ·Ø§Ø©</div></div>
</div>

<div class="section-title">
  <h2>ØªØµÙØ­ Ø­Ø³Ø¨ Ø§Ù„ÙØ¦Ø©</h2>
  <p>Ø§Ø®ØªØ± Ø§Ù„ÙØ¦Ø© Ø§Ù„ØªÙŠ ØªØ¨Ø­Ø« Ø¹Ù†Ù‡Ø§</p>
  <div class="line"></div>
</div>

<div class="categories-grid">
  <div class="cat-card" onclick="toggleCatPanel('Ø³ÙŠØ§Ø±Ø§Øª','ğŸš—',this)"><span class="cat-icon">ğŸš—</span><div class="cat-name">Ø³ÙŠØ§Ø±Ø§Øª</div><div class="cat-count">3,210 Ø¥Ø¹Ù„Ø§Ù†</div></div>
  <div class="cat-card" onclick="toggleCatPanel('Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª','ğŸ“±',this)"><span class="cat-icon">ğŸ“±</span><div class="cat-name">Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª</div><div class="cat-count">8,540 Ø¥Ø¹Ù„Ø§Ù†</div></div>
  <div class="cat-card" onclick="toggleCatPanel('Ø¹Ù‚Ø§Ø±Ø§Øª','ğŸ ',this)"><span class="cat-icon">ğŸ </span><div class="cat-name">Ø¹Ù‚Ø§Ø±Ø§Øª</div><div class="cat-count">1,875 Ø¥Ø¹Ù„Ø§Ù†</div></div>
  <div class="cat-card" onclick="toggleCatPanel('Ù…Ù„Ø§Ø¨Ø³','ğŸ‘—',this)"><span class="cat-icon">ğŸ‘—</span><div class="cat-name">Ù…Ù„Ø§Ø¨Ø³</div><div class="cat-count">5,320 Ø¥Ø¹Ù„Ø§Ù†</div></div>
  <div class="cat-card" onclick="toggleCatPanel('Ø£Ø«Ø§Ø«','ğŸ›‹ï¸',this)"><span class="cat-icon">ğŸ›‹ï¸</span><div class="cat-name">Ø£Ø«Ø§Ø«</div><div class="cat-count">2,100 Ø¥Ø¹Ù„Ø§Ù†</div></div>
  <div class="cat-card" onclick="toggleCatPanel('Ø¯Ø±Ø§Ø¬Ø§Øª','ğŸï¸',this)"><span class="cat-icon">ğŸï¸</span><div class="cat-name">Ø¯Ø±Ø§Ø¬Ø§Øª</div><div class="cat-count">980 Ø¥Ø¹Ù„Ø§Ù†</div></div>
  <div class="cat-card" onclick="toggleCatPanel('ÙˆØ¸Ø§Ø¦Ù','ğŸ’¼',this)"><span class="cat-icon">ğŸ’¼</span><div class="cat-name">ÙˆØ¸Ø§Ø¦Ù</div><div class="cat-count">4,200 Ø¥Ø¹Ù„Ø§Ù†</div></div>
  <div class="cat-card" onclick="toggleCatPanel('Ø®Ø¯Ù…Ø§Øª','ğŸ”§',this)"><span class="cat-icon">ğŸ”§</span><div class="cat-name">Ø®Ø¯Ù…Ø§Øª</div><div class="cat-count">3,600 Ø¥Ø¹Ù„Ø§Ù†</div></div>
  <div class="cat-card" onclick="toggleCatPanel('Ø­ÙŠÙˆØ§Ù†Ø§Øª','ğŸ•',this)"><span class="cat-icon">ğŸ•</span><div class="cat-name">Ø­ÙŠÙˆØ§Ù†Ø§Øª</div><div class="cat-count">1,450 Ø¥Ø¹Ù„Ø§Ù†</div></div>
  <div class="cat-card" onclick="toggleCatPanel('Ø±ÙŠØ§Ø¶Ø©','âš½',this)"><span class="cat-icon">âš½</span><div class="cat-name">Ø±ÙŠØ§Ø¶Ø©</div><div class="cat-count">2,800 Ø¥Ø¹Ù„Ø§Ù†</div></div>
  <div class="cat-card" onclick="toggleCatPanel('Ø£Ù„Ø¹Ø§Ø¨','ğŸ®',this)"><span class="cat-icon">ğŸ®</span><div class="cat-name">Ø£Ù„Ø¹Ø§Ø¨</div><div class="cat-count">3,100 Ø¥Ø¹Ù„Ø§Ù†</div></div>
  <div class="cat-card" onclick="toggleCatPanel('ÙƒØªØ¨ ÙˆØªØ¹Ù„ÙŠÙ…','ğŸ“š',this)"><span class="cat-icon">ğŸ“š</span><div class="cat-name">ÙƒØªØ¨ ÙˆØªØ¹Ù„ÙŠÙ…</div><div class="cat-count">1,230 Ø¥Ø¹Ù„Ø§Ù†</div></div>
</div>

<div class="cat-ads-panel" id="catAdsPanel" style="display:none;"></div>

<div class="ads-section">
  <div class="section-title" style="text-align:right;margin-bottom:20px;">
    <h2 style="font-size:1.4rem;">Ø£Ø­Ø¯Ø« Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ğŸ”¥</h2>
  </div>
  <div class="filter-tabs">
    <button class="filter-tab active" onclick="filterAds(this,'')">Ø§Ù„ÙƒÙ„</button>
    <button class="filter-tab" onclick="filterAds(this,'Ù„Ù„Ø¨ÙŠØ¹')">Ù„Ù„Ø¨ÙŠØ¹</button>
    <button class="filter-tab" onclick="filterAds(this,'Ù„Ù„Ø¥ÙŠØ¬Ø§Ø±')">Ù„Ù„Ø¥ÙŠØ¬Ø§Ø±</button>
    <button class="filter-tab" onclick="filterAds(this,'Ù…Ø·Ù„ÙˆØ¨')">Ù…Ø·Ù„ÙˆØ¨</button>
    <button class="filter-tab" onclick="filterAds(this,'Ù…Ø¬Ø§Ù†ÙŠ')">Ù…Ø¬Ø§Ù†ÙŠ</button>
  </div>
  <div class="ads-grid" id="adsGrid">
    <div style="grid-column:1/-1;text-align:center;padding:60px 20px;color:var(--text-muted);">
      <div class="spinner" style="border-color:rgba(255,107,53,0.3);border-top-color:var(--primary);width:40px;height:40px;border-width:3px;margin:0 auto 16px;"></div>
      <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª...</p>
    </div>
  </div>
</div>

<footer>
  <div class="footer-logo">ğŸ›’ Algerie-Market</div>
  <p>Â© 2024 Algerie-Market â€” Ù…Ù†ØµØ© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ© Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±ÙŠØ© ğŸ‡©ğŸ‡¿</p>
</footer>

<div class="modal-overlay" id="modalOverlay" onclick="handleOverlayClick(event)">
  <div class="modal" id="modal">
    <div class="modal-header">
      <span class="modal-title" id="modalTitle">Ø£Ø¶Ù Ø¥Ø¹Ù„Ø§Ù†Ùƒ</span>
      <button class="modal-close" onclick="closeModal()">âœ•</button>
    </div>
    <div class="modal-body" id="modalBody"></div>
  </div>
</div>

<div class="toast" id="toast"></div>

<script>
  let allAds=[],catAds={},currentFilter='',selectedCategory='',activeCatEl=null;

  function showToast(msg,color='#00C896'){
    const t=document.getElementById('toast');
    t.textContent=msg;t.style.background=color;
    t.classList.add('show');setTimeout(()=>t.classList.remove('show'),3500);
  }

  function adCardHTML(ad,delay=0){
    const emoji=ad.emoji||'ğŸ“¦';
    const photo=ad.userPhoto
      ?`<div class="seller-avatar"><img src="${ad.userPhoto}" alt=""></div>`
      :`<div class="seller-avatar">${(ad.userName||'Ù…')[0]}</div>`;
    return `
      <div class="ad-card" style="animation-delay:${delay}s">
        <div class="ad-image">${emoji}<span class="ad-badge ${ad.type==='Ù„Ù„Ø¥ÙŠØ¬Ø§Ø±'?'sale':''}">${ad.type||'Ø¨ÙŠØ¹'}</span></div>
        <div class="ad-body">
          <div class="ad-title">${ad.title}</div>
          <div class="ad-meta"><span>ğŸ“ ${ad.city||''}</span><span>ğŸ·ï¸ ${ad.cat||''}</span></div>
          <div class="ad-price">${ad.price}</div>
          <div class="ad-footer">
            <div class="ad-seller">${photo} ${ad.userName||'Ù…Ø³ØªØ®Ø¯Ù…'}</div>
            <button class="btn-contact">ØªÙˆØ§ØµÙ„</button>
          </div>
        </div>
      </div>`;
  }

  function renderAds(ads){
    const grid=document.getElementById('adsGrid');
    if(!ads||ads.length===0){
      grid.innerHTML=`<div style="grid-column:1/-1;text-align:center;padding:60px;color:var(--text-muted);"><div style="font-size:3rem;margin-bottom:16px;">ğŸ“­</div><p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø¨Ø¹Ø¯. ÙƒÙ† Ø£ÙˆÙ„ Ù…Ù† ÙŠÙ†Ø´Ø±!</p></div>`;
      return;
    }
    grid.innerHTML=ads.map((ad,i)=>adCardHTML(ad,i*0.07)).join('');
  }

  function filterAds(btn,type){
    document.querySelectorAll('.filter-tab').forEach(t=>t.classList.remove('active'));
    btn.classList.add('active');currentFilter=type;
    renderAds(type?allAds.filter(a=>(a.type||'').includes(type)):allAds);
  }

  async function loadAdsFromFirebase(){
    try{
      const ads=await window.firebaseGetAds();
      allAds=ads;
      ads.forEach(ad=>{const c=ad.cat||'Ø£Ø®Ø±Ù‰';if(!catAds[c])catAds[c]=[];catAds[c].push(ad);});
      renderAds(ads);
    }catch(err){
      console.warn("Firebase:",err.message);
      const demo=[
        {emoji:'ğŸ“±',title:'Ø¢ÙŠÙÙˆÙ† 14 Ø¨Ø±Ùˆ Ù…Ø§ÙƒØ³',price:'120,000 Ø¯Ø¬',city:'Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±',cat:'Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª',type:'Ù„Ù„Ø¨ÙŠØ¹',userName:'Ø£Ù…ÙŠÙ†',userPhoto:''},
        {emoji:'ğŸš—',title:'Ø±ÙˆÙ†Ùˆ ÙƒÙ„ÙŠÙˆ 2020',price:'2,800,000 Ø¯Ø¬',city:'ÙˆÙ‡Ø±Ø§Ù†',cat:'Ø³ÙŠØ§Ø±Ø§Øª',type:'Ù„Ù„Ø¨ÙŠØ¹',userName:'ÙƒØ±ÙŠÙ…',userPhoto:''},
        {emoji:'ğŸ›‹ï¸',title:'Ø·Ù‚Ù… ØµØ§Ù„ÙˆÙ† ÙØ§Ø®Ø±',price:'85,000 Ø¯Ø¬',city:'Ù‚Ø³Ù†Ø·ÙŠÙ†Ø©',cat:'Ø£Ø«Ø§Ø«',type:'Ù„Ù„Ø¨ÙŠØ¹',userName:'Ø³Ø§Ø±Ø©',userPhoto:''},
        {emoji:'ğŸ ',title:'Ø´Ù‚Ø© Ù„Ù„Ø¥ÙŠØ¬Ø§Ø± - 3 ØºØ±Ù',price:'35,000 Ø¯Ø¬/Ø´Ù‡Ø±',city:'Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±',cat:'Ø¹Ù‚Ø§Ø±Ø§Øª',type:'Ù„Ù„Ø¥ÙŠØ¬Ø§Ø±',userName:'Ù…Ø­Ù…Ø¯',userPhoto:''},
        {emoji:'ğŸ®',title:'Ø¨Ù„Ø§ÙŠ Ø³ØªÙŠØ´Ù† 5',price:'75,000 Ø¯Ø¬',city:'Ø¹Ù†Ø§Ø¨Ø©',cat:'Ø£Ù„Ø¹Ø§Ø¨',type:'Ù„Ù„Ø¨ÙŠØ¹',userName:'Ø¹Ù…Ø±',userPhoto:''},
        {emoji:'ğŸ‘—',title:'Ù‚Ù†Ø¯ÙˆØ±Ø© Ø¹ØµØ±ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©',price:'8,500 Ø¯Ø¬',city:'ØªÙ„Ù…Ø³Ø§Ù†',cat:'Ù…Ù„Ø§Ø¨Ø³',type:'Ù„Ù„Ø¨ÙŠØ¹',userName:'Ù„ÙŠÙ„Ù‰',userPhoto:''},
      ];
      allAds=demo;renderAds(demo);
    }
  }

  function toggleCatPanel(catName,catIcon,el){
    const panel=document.getElementById('catAdsPanel');
    if(activeCatEl===el&&panel.style.display!=='none'){panel.style.display='none';el.classList.remove('active-cat');activeCatEl=null;return;}
    if(activeCatEl)activeCatEl.classList.remove('active-cat');
    activeCatEl=el;el.classList.add('active-cat');
    const ads=catAds[catName]||[];
    panel.style.display='block';
    panel.innerHTML=`
      <div class="cat-ads-inner">
        <div class="cat-panel-header">
          <div class="cat-panel-title">${catIcon} ${catName}<span class="cat-panel-count">${ads.length} Ø¥Ø¹Ù„Ø§Ù†</span></div>
          <div style="display:flex;gap:10px;align-items:center;">
            <button class="btn-add-in-cat" onclick="openModalWithCategory('${catName}')">+ Ø£Ø¶Ù Ø¥Ø¹Ù„Ø§Ù†</button>
            <button class="btn-panel-close" onclick="closeCatPanel()">âœ•</button>
          </div>
        </div>
        ${ads.length===0?`
          <div class="panel-empty">
            <span class="empty-icon">${catIcon}</span>
            <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„ÙØ¦Ø© Ø¨Ø¹Ø¯</p>
            <button class="btn-add-in-cat" onclick="openModalWithCategory('${catName}')">+ ÙƒÙ† Ø£ÙˆÙ„ Ù…Ù† ÙŠØ¶ÙŠÙ Ø¥Ø¹Ù„Ø§Ù†Ø§Ù‹</button>
          </div>`:`
          <div class="panel-ads-grid">${ads.map(ad=>adCardHTML(ad)).join('')}</div>`}
      </div>`;
    panel.scrollIntoView({behavior:'smooth',block:'nearest'});
  }

  function closeCatPanel(){
    document.getElementById('catAdsPanel').style.display='none';
    if(activeCatEl)activeCatEl.classList.remove('active-cat');activeCatEl=null;
  }

  function openModal(){
    document.getElementById('modalOverlay').classList.add('open');
    window.currentUser?showCategoryStep():showAuthStep();
  }

  function openModalWithCategory(cat){selectedCategory=cat;openModal();}

  function closeModal(){
    document.getElementById('modalOverlay').classList.remove('open');
    setTimeout(()=>{selectedCategory='';},400);
  }

  function handleOverlayClick(e){if(e.target===document.getElementById('modalOverlay'))closeModal();}

  function showAuthStep(){
    document.getElementById('modalTitle').textContent='Ø£Ø¶Ù Ø¥Ø¹Ù„Ø§Ù†Ùƒ';
    document.getElementById('modalBody').innerHTML=`
      <div class="auth-step">
        <div class="auth-icon">ğŸ”</div>
        <div class="auth-title">Ø³Ø¬Ù‘Ù„ Ø¯Ø®ÙˆÙ„Ùƒ Ù„Ù†Ø´Ø± Ø¥Ø¹Ù„Ø§Ù†Ùƒ</div>
        <div class="auth-sub">Ø§Ù†Ø¶Ù… Ù„Ø¢Ù„Ø§Ù Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±ÙŠÙŠÙ† Ø§Ù„Ø¨Ø§Ø¦Ø¹ÙŠÙ† ÙˆØ§Ù„Ù…Ø´ØªØ±ÙŠÙ† Ø¹Ù„Ù‰ Algerie-Market</div>
        <button class="btn-google" id="btnGoogle" onclick="doGoogleLogin()">
          <div class="google-logo"></div>
          ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù€ Google
        </button>
        <div class="divider">Ø£Ù…Ø§Ù† ØªØ§Ù… â€¢ Ù…Ø¬Ø§Ù†ÙŠ â€¢ Ø³Ø±ÙŠØ¹</div>
        <p style="font-size:.82rem;color:var(--text-muted);line-height:1.6;">ğŸ”’ Ù†Ø³ØªØ®Ø¯Ù… Google Ù„Ø­Ù…Ø§ÙŠØ© Ø­Ø³Ø§Ø¨Ùƒ</p>
      </div>`;
  }

  async function doGoogleLogin(){
    const btn=document.getElementById('btnGoogle');
    btn.innerHTML=`<div class="spinner"></div> Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ³Ø¬ÙŠÙ„...`;btn.disabled=true;
    const user=await window.firebaseLoginWithGoogle();
    if(user){showToast(`Ù…Ø±Ø­Ø¨Ø§Ù‹ ${user.displayName} ğŸ‘‹`);showCategoryStep();}
    else{btn.innerHTML=`<div class="google-logo"></div> ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù€ Google`;btn.disabled=false;}
  }

  function showCategoryStep(){
    document.getElementById('modalTitle').textContent='Ø§Ø®ØªØ± ÙØ¦Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†';
    const cats=[
      {icon:'ğŸš—',name:'Ø³ÙŠØ§Ø±Ø§Øª'},{icon:'ğŸ“±',name:'Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª'},
      {icon:'ğŸ ',name:'Ø¹Ù‚Ø§Ø±Ø§Øª'},{icon:'ğŸ‘—',name:'Ù…Ù„Ø§Ø¨Ø³'},
      {icon:'ğŸ›‹ï¸',name:'Ø£Ø«Ø§Ø«'},{icon:'ğŸï¸',name:'Ø¯Ø±Ø§Ø¬Ø§Øª'},
      {icon:'ğŸ’¼',name:'ÙˆØ¸Ø§Ø¦Ù'},{icon:'ğŸ”§',name:'Ø®Ø¯Ù…Ø§Øª'},
      {icon:'ğŸ•',name:'Ø­ÙŠÙˆØ§Ù†Ø§Øª'},{icon:'âš½',name:'Ø±ÙŠØ§Ø¶Ø©'},
      {icon:'ğŸ®',name:'Ø£Ù„Ø¹Ø§Ø¨'},{icon:'ğŸ“š',name:'ÙƒØªØ¨'},
    ];
    document.getElementById('modalBody').innerHTML=`
      <div class="steps-indicator">
        <div class="step-dot done"></div><div class="step-dot active"></div><div class="step-dot"></div>
      </div>
      <div class="cats-select">
        ${cats.map(c=>`
          <div class="cat-select-item ${c.name===selectedCategory?'selected':''}" onclick="selectCategory('${c.name}',this)">
            <span class="icon">${c.icon}</span><span class="name">${c.name}</span>
          </div>`).join('')}
      </div>
      <button class="btn-submit" onclick="showFormStep()">Ø§Ù„ØªØ§Ù„ÙŠ â†</button>`;
  }

  function selectCategory(name,el){
    document.querySelectorAll('.cat-select-item').forEach(c=>c.classList.remove('selected'));
    el.classList.add('selected');selectedCategory=name;
  }

  function showFormStep(){
    if(!selectedCategory){showToast('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± ÙØ¦Ø© Ø£ÙˆÙ„Ø§Ù‹','#FF6B35');return;}
    document.getElementById('modalTitle').textContent=`Ø¥Ø¹Ù„Ø§Ù† ÙÙŠ: ${selectedCategory}`;
    document.getElementById('modalBody').innerHTML=`
      <div class="steps-indicator">
        <div class="step-dot done"></div><div class="step-dot done"></div><div class="step-dot active"></div>
      </div>
      <div class="form-group">
        <label class="form-label">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† <span>*</span></label>
        <input class="form-control" id="adTitle" type="text" placeholder="Ù…Ø«Ø§Ù„: Ù‡Ø§ØªÙ Ø³Ø§Ù…Ø³ÙˆÙ†Ø¬ S23 Ø¬Ø¯ÙŠØ¯">
      </div>
      <div class="form-group">
        <label class="form-label">Ø§Ù„ÙˆØµÙ <span>*</span></label>
        <textarea class="form-control" id="adDesc" placeholder="Ø§ÙƒØªØ¨ ÙˆØµÙØ§Ù‹ ØªÙØµÙŠÙ„ÙŠØ§Ù‹..."></textarea>
      </div>
      <div class="form-row">
        <div class="form-group">
          <label class="form-label">Ø§Ù„Ø³Ø¹Ø± <span>*</span></label>
          <input class="form-control" id="adPrice" type="number" placeholder="0">
        </div>
        <div class="form-group">
          <label class="form-label">Ø§Ù„Ø¹Ù…Ù„Ø©</label>
          <select class="form-control" id="adCurrency"><option>Ø¯Ø¬</option><option>â‚¬</option><option>$</option></select>
        </div>
      </div>
      <div class="form-row">
        <div class="form-group">
          <label class="form-label">Ø§Ù„ÙˆÙ„Ø§ÙŠØ© <span>*</span></label>
          <select class="form-control" id="adCity">
            <option value="">-- Ø§Ø®ØªØ± Ø§Ù„ÙˆÙ„Ø§ÙŠØ© --</option>
            <option>Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±</option><option>ÙˆÙ‡Ø±Ø§Ù†</option><option>Ù‚Ø³Ù†Ø·ÙŠÙ†Ø©</option>
            <option>Ø¹Ù†Ø§Ø¨Ø©</option><option>ØªÙ„Ù…Ø³Ø§Ù†</option><option>Ø³Ø·ÙŠÙ</option>
            <option>Ø¨Ø¬Ø§ÙŠØ©</option><option>Ø¨Ø³ÙƒØ±Ø©</option><option>ØªÙŠØ²ÙŠ ÙˆØ²Ùˆ</option>
            <option>Ø§Ù„Ø¨Ù„ÙŠØ¯Ø©</option><option>Ø¨Ø§ØªÙ†Ø©</option><option>Ù…Ø³ØªØºØ§Ù†Ù…</option>
            <option>Ø³ÙŠØ¯ÙŠ Ø¨Ù„Ø¹Ø¨Ø§Ø³</option><option>Ø§Ù„Ø´Ù„Ù</option><option>Ø¬ÙŠØ¬Ù„</option>
            <option>ÙˆØ±Ù‚Ù„Ø©</option><option>Ø£Ø¯Ø±Ø§Ø±</option><option>ØªÙ…Ù†Ø±Ø§Ø³Øª</option>
            <option>ØºØ±Ø¯Ø§ÙŠØ©</option><option>ØªÙŠØ§Ø±Øª</option><option>Ø§Ù„Ù…Ø¯ÙŠØ©</option><option>Ø£Ø®Ø±Ù‰</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†</label>
          <select class="form-control" id="adType">
            <option>Ù„Ù„Ø¨ÙŠØ¹</option><option>Ù„Ù„Ø¥ÙŠØ¬Ø§Ø±</option><option>Ù…Ø·Ù„ÙˆØ¨</option><option>Ù…Ø¬Ø§Ù†ÙŠ</option>
          </select>
        </div>
      </div>
      <div class="form-group">
        <label class="form-label">Ø±Ù‚Ù… Ø§Ù„ØªÙˆØ§ØµÙ„</label>
        <input class="form-control" id="adPhone" type="tel" placeholder="+213 5XX XX XX XX">
      </div>
      <button class="btn-submit" id="btnPublish" onclick="submitAd()">ğŸš€ Ù†Ø´Ø± Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø§Ù„Ø¢Ù†</button>
      <button class="btn-back" onclick="showCategoryStep()">â† Ø±Ø¬ÙˆØ¹</button>`;
  }

  async function submitAd(){
    const title=document.getElementById('adTitle')?.value.trim();
    const desc=document.getElementById('adDesc')?.value.trim();
    const price=document.getElementById('adPrice')?.value;
    const city=document.getElementById('adCity')?.value;
    const type=document.getElementById('adType')?.value;
    const currency=document.getElementById('adCurrency')?.value;
    const phone=document.getElementById('adPhone')?.value.trim();
    if(!title){showToast('ÙŠØ±Ø¬Ù‰ ÙƒØªØ§Ø¨Ø© Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†','#FF6B35');return;}
    if(!price){showToast('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø³Ø¹Ø±','#FF6B35');return;}
    if(!city){showToast('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙˆÙ„Ø§ÙŠØ©','#FF6B35');return;}
    const btn=document.getElementById('btnPublish');
    btn.innerHTML=`<div class="spinner"></div> Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù†Ø´Ø±...`;btn.disabled=true;
    const catEmojis={'Ø³ÙŠØ§Ø±Ø§Øª':'ğŸš—','Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª':'ğŸ“±','Ø¹Ù‚Ø§Ø±Ø§Øª':'ğŸ ','Ù…Ù„Ø§Ø¨Ø³':'ğŸ‘—','Ø£Ø«Ø§Ø«':'ğŸ›‹ï¸','Ø¯Ø±Ø§Ø¬Ø§Øª':'ğŸï¸','ÙˆØ¸Ø§Ø¦Ù':'ğŸ’¼','Ø®Ø¯Ù…Ø§Øª':'ğŸ”§','Ø­ÙŠÙˆØ§Ù†Ø§Øª':'ğŸ•','Ø±ÙŠØ§Ø¶Ø©':'âš½','Ø£Ù„Ø¹Ø§Ø¨':'ğŸ®','ÙƒØªØ¨':'ğŸ“š'};
    const adData={title,desc,price:`${Number(price).toLocaleString()} ${currency}`,city,type,phone,cat:selectedCategory,category:selectedCategory,emoji:catEmojis[selectedCategory]||'ğŸ“¦'};
    try{
      const id=await window.firebaseSaveAd(adData);
      const newAd={id,...adData,userName:window.currentUser?.displayName||'Ù…Ø³ØªØ®Ø¯Ù…',userPhoto:window.currentUser?.photoURL||''};
      allAds.unshift(newAd);
      if(!catAds[selectedCategory])catAds[selectedCategory]=[];
      catAds[selectedCategory].unshift(newAd);
      renderAds(allAds);
      document.getElementById('modalTitle').textContent='ØªÙ… Ø§Ù„Ù†Ø´Ø± Ø¨Ù†Ø¬Ø§Ø­ ğŸ‰';
      document.getElementById('modalBody').innerHTML=`
        <div class="success-state">
          <div class="success-icon">âœ…</div>
          <h3 style="font-family:'Cairo',sans-serif;font-size:1.3rem;font-weight:800;margin-bottom:10px;">Ø¥Ø¹Ù„Ø§Ù†Ùƒ ØªÙ… Ù†Ø´Ø±Ù‡!</h3>
          <p style="color:var(--text-muted);font-size:.9rem;margin-bottom:28px;">Ø³ÙŠØ¸Ù‡Ø± Ø¥Ø¹Ù„Ø§Ù†Ùƒ Ù„Ø¢Ù„Ø§Ù Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±ÙŠÙŠÙ† Ø§Ù„Ø¢Ù† ğŸ‡©ğŸ‡¿</p>
          <button class="btn-submit" onclick="closeModal()">Ø±Ø§Ø¦Ø¹ØŒ Ø´ÙƒØ±Ø§Ù‹! ğŸŠ</button>
          <button class="btn-back" onclick="selectedCategory='';showCategoryStep()">Ø¥Ø¶Ø§ÙØ© Ø¥Ø¹Ù„Ø§Ù† Ø¢Ø®Ø±</button>
        </div>`;
      showToast('âœ… ØªÙ… Ù†Ø´Ø± Ø¥Ø¹Ù„Ø§Ù†Ùƒ Ø¨Ù†Ø¬Ø§Ø­!');
    }catch(err){
      console.error(err);
      showToast('Ø­Ø¯Ø« Ø®Ø·Ø£ØŒ ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase','#FF6B35');
      btn.innerHTML='ğŸš€ Ù†Ø´Ø± Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø§Ù„Ø¢Ù†';btn.disabled=false;
    }
  }

  async function logoutUser(){
    await window.firebaseLogout();
    showToast('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ ğŸ‘‹','#8899BB');
  }

  window.currentUser=null;
  setTimeout(loadAdsFromFirebase,1000);
</script>
</body>
                                                            </html>
